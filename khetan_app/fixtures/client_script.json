[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Material Request",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.550578",
  "module": "khetan_app",
  "name": "Calculate Amount In Material request",
  "script": "frappe.ui.form.on(\"Material Request\",{\r\tafter_save: function(frm)\r\t{\r\t    \r\t\t$.each(frm.doc.items || [], function (i, d)\r        {\t\t\r            var a = d.qty;\r            var b = d.rate;\r    \t\tvar c = a * b;\r    \t\tvar h = d.amount;\r    \t\tif(b == h )\r    \t\t\r    \t\t{\r    \t\t    d.amount = c;\r    \t\t}\r        });\r    {\r        var grand_total = 0;\r        $.each(frm.doc.items, function(i, d) {\r                grand_total += d.amount;\r        });\r        frm.set_value(\"total_amount\",grand_total);\r        frm.refresh_field(\"total_amount\");\r    }    \r    }\r});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.211806",
  "module": "khetan_app",
  "name": "Manual Weight Entry",
  "script": "// frappe.ui.form.on('Quotation Item', {\r// \tqty:function(frm) {\r// \t    var a = cur_frm.doc.customer_type;\r// \t   // console.log(a);\r// \t   // alert(a);\r// \t    if(a == \"Special\"){\r// \t        alert(\"hey you are special customer\")\r// \t        $.each(frm.doc.items || {}, function (i, d){\r// \t\t      var item = d.item_code;\r// \t\t      frappe.call({\r// \t\t          method:\"weight\",\r// \t\t          args:{\"item\":item},\r// \t\t      }).then(records => {\r//                         // alert(records[\"message\"]);\r//                         var weight = records['msg']\r//                         d.weight_per_unit = weight;\r//                         // console.log(d.pcs)\r//                         // d.qty=d.pcs;\r// \t\t      });\r// \t\t  })\r// \t    }\r// \t}\r// })\rfrappe.ui.form.on(\"Quotation Item\", \"pcs\",function(frm, cdt, cdn){\r    var d = locals[cdt][cdn];\r    if (d.item_type==\"Pipe 202\" || d.item_type==\"Pipe 202\" || d.item_type==\"Pipe 304\" || d.item_type==\"Pipe 316\" || d.item_type==\"Sheet 202\" || d.item_type==\"Sheet 304\"){\r        var cust_type = cur_frm.doc.customer_type;\r        if (cust_type==\"Special\"){\r            // alert(\"hey you are special customer\")\r            var item = d.item_code;\r            frappe.call({\r    \t\t          method:\"weight\",\r    \t\t          args:{\"item\":item},\r    \t\t      }).then(records => {\r                            // alert(records[\"message\"]);\r                        var weight = records['msg']\r                        d.weight_per_unit = weight;\r                        // console.log(d.pcs)\r                        var pcs=d.pcs;\r                        console.log(\"this is qty send\")\r                        frappe.model.set_value(cdt, cdn, \"qty\", pcs);\r                        frappe.model.set_value(cdt, cdn, \"weight_per_unit\", weight); \r    \t\t      });        \r        }\r        else if (cust_type==\"General\"){\r            var pcs1=d.pcs;\r            frappe.model.set_value(cdt, cdn, \"qty\", pcs1);       \r        }\r    }\r    else{\r        var pcs2=d.pcs;\r        frappe.model.set_value(cdt, cdn, \"qty\", pcs2);  \r    }\r    // alert(\"This is special size block\");\r    \r    \r    \r    \r    \r    // var cust_type = cur_frm.doc.customer_type;\r    // if (cust_type==\"Special\"){\r    //     // alert(\"hey you are special customer\")\r    //     var item = d.item_code;\r    //     frappe.call({\r\t\t  //        method:\"weight\",\r\t\t  //        args:{\"item\":item},\r\t\t  //    }).then(records => {\r    //                     // alert(records[\"message\"]);\r    //                 var weight = records['msg']\r    //                 d.weight_per_unit = weight;\r    //                 // console.log(d.pcs)\r    //                 var pcs=d.pcs;\r    //                 console.log(\"this is qty send\")\r    //                 frappe.model.set_value(cdt, cdn, \"qty\", pcs);\r    //                 frappe.model.set_value(cdt, cdn, \"weight_per_unit\", weight); \r\t\t  //    });        \r    // }\r    // else if (cust_type==\"General\"){\r    //     var pcs1=d.pcs;\r    //     frappe.model.set_value(cdt, cdn, \"qty\", pcs1);       \r    // }\r    \r    \r    \r    \r    \r    // else if(cust_type==\"General\"){\r        \r    // }\r    // var default_set = d.default_set\r    // var total_set = qty_box * default_set;\r    // var total_set = qty_box\r    // var total_inches = total_set * d.special_size;\r    // alert(total_inches);\r    // alert(total_set);\r    // frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\r    // frappe.model.set_value(cdt, cdn, \"qty\", total_set);\r    // frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches);\r    // if (d.price_list_rate !== \"\"){\r    //     // alert(\"hey\")\r    //     var rate=d.price_amt*d.special_size;\r    //     frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate);\r    // }\r});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.421633",
  "module": "khetan_app",
  "name": "Customer Type Quotation",
  "script": "frappe.ui.form.on('Quotation', {\n\tcustomer_name:function(frm) {\n\t\t// your code here\n\t\tvar cus_name = cur_frm.doc.customer_name;\n// \t\tconsole.log(cus_name)\n\t\tfrappe.call({\n\t\t          method:\"cus_name\",\n\t\t          args:{\"cus_name\":cus_name},\n\t\t            }).then(records => {\n                        var rates_t = records['msg']\n                        // console.log(rates_t);\n                        cur_frm.doc.customer_type = rates_t;\n\t\t            });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.315956",
  "module": "khetan_app",
  "name": "Get Values For Quotation Item",
  "script": "frappe.ui.form.on('Quotation Item', {\n    item_code:function(frm) {\n\t\t// your code here\n\t\t var item_code = 0;\n// \t\t var inches = 0;\n\t\t var rate = 0;\n\t\t $.each(frm.doc.items || {}, function (i, d){\n\t\t      item_code = d.item_code;\n\t\t      //rate = d.rate;\n\t\t      //alert(rate);\n\t\t      frappe.call({\n\t\t          method:\"inches\",\n\t\t          args:{\"item_code\":item_code},\n\t\t            }).then(records => {\n                        var inches = records['msg']\n                        var grade = records['grade']\n                        // var type1 = records['type']\n                        var shape_type = records['shape_type']\n                        var thickness = records['thickness']\n                        var company = records['company']\n                        // var default_set = records['default_set']\n                        var color = records['color']\n                        var products_type = records['products_type']\n                        var item_type = records['item_type']\n                        var normal_margin = records['normal_margin']\n                        var special_margin = records['special_margin']\n                        // console.log(color);\n                        // console.log(inches)\n                        // alert(color);\n                        d.grade = grade;\n                        d.shape_type = shape_type;\n                        d.thickness = thickness;\n                        d.size = inches;\n                        d.company = company;\n                        // d.default_set = default_set;\n                        d.color = color;\n                        d.products_type = products_type;\n                        d.item_type = item_type;\n                        d.normal_margin = normal_margin;\n                        d.special_margin = special_margin;\n\t\t            });\n\t   });\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.367164",
  "module": "khetan_app",
  "name": "Set Grade Counts",
  "script": "frappe.ui.form.on('Quotation', {\n\tbefore_save(frm) {\n\t    var name  = frm.doc.name;\n\t    var qty = 0\n\t    var n=\"\"\n\t    var m=\"\"\n\t    var z=\"\"\n\t\t$.each(frm.doc.items || [], function(i,d){\n\t\t \n\t\t   var a = d.grade;\n\t\t    if(a==\"202\"){\n\t\t        if(n===\"\"){\n\t\t         n =  d.item_code;\n\t\t        }\n\t\t        else{\n\t\t            n=n+ \",\" + d.item_code;\n\t\t        }\n\t\t    }\n\t\t    \n\t\t    else if(a==\"316\"){\n\t\t        if(m===\"\"){\n\t\t         m =  d.item_code ;\n\t\t        }\n\t\t        else{\n\t\t            m=m+ \",\" + d.item_code;\n\t\t        }\n\t\t    }\n\t\t     else if(a ==\"304\"){\n\t\t         if(z===\"\"){\n\t\t         z =  d.item_code ;\n\t\t        }\n\t\t        else{\n\t\t            z=z+ \",\" + d.item_code;\n\t\t        }\n\t\t    }\n\t\t});\n\t\t\n\t\t$.each(frm.doc.items || [], function(i,d){\n\t\t         qty = qty + parseFloat(d.weight);\n\t\t});\n\t\tvar a1,b1,c1;\n\t\tif (n===\"\"){\n\t\t    var n1=0;\n\t\t    frm.set_value(\"quantity202\",a1);\n\t\t}\n\t\telse{\n\t\t     var n2=n.split(\",\");\n\t\t     a1=n2.length;\n\t\t     frm.set_value(\"quantity202\",a1);\n\t\t}\n\t\tif (m===\"\"){\n\t\t    var m1=0;\n\t\t    b1=0;\n\t\t    frm.set_value(\"quantity316\",b1);\n\t\t}\n\t\telse{\n\t\t     var m2=m.split(\",\");\n\t\t     b1=m2.length;\n\t\t     frm.set_value(\"quantity316\",b1);\n\t\t} \n\t\tif (z===\"\"){\n\t\t    var z1=0;\n\t\t    c1=0;\n\t\t    frm.set_value(\"quantity304\",c1);\n\t\t}\n\t\telse{\n\t\t     var z2=z.split(\",\");\n\t\t     c1=z2.length;\n\t\t     frm.set_value(\"quantity304\",c1);\n\t\t}\n\t\tvar total_no_items=a1+b1+c1;\n\t\tfrm.set_value(\"total_no_items\",total_no_items);\n\t\tfrm.set_value(\"total_sold_weight\",qty);\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 0,
  "modified": "2023-02-07 18:11:35.155223",
  "module": "khetan_app",
  "name": "Weight Difference",
  "script": "frappe.ui.form.on('Quotation Item', {\n\tweight:function(frm) {\n\t   var we = 0;\n\t   var total_weight = 0;\n\t   var we_diff = 0;\n\t   // alert(we);\n\t   $.each(frm.doc.items || {}, function (i, d){\n\t\t      we = d.weight;\n\t\t      total_weight = d.total_weight;\n\t\t      we_diff=total_weight-we;\n\t\t      frappe.call({\n\t\t          method:\"send_value\",\n\t\t          args:{\"we_diff\":we_diff},\n\t\t            }).then(records => {\n                        var weight_diff = records['msg']\n                        d.weight_diff = weight_diff;\n\t\t            });\n\t   });\n\t}\n});\n// frappe.ui.form.on(\"Quotation Item\", \"weight\",function(frm, cdt, cdn){\n//     var a1 = cur_frm.doc.rate_1;\n//     var b1 = cur_frm.doc.rate_2;\n//     var c1 = cur_frm.doc.rate_3;\n//     var d = locals[cdt][cdn];\n//     // var grade = d.grade;\n//     var select_item_type = cur_frm.doc.select_item_type;\n    \n//     if (d.select_item_type==\"Guage and Sheet\"){\n//         var rate202 = cur_frm.doc.rate202;\n//         var rate304 = cur_frm.doc.rate304;\n//         var rate316 = cur_frm.doc.rate316;\n//         var sheet202 = cur_frm.doc.sheet202;\n//         var sheet304 = cur_frm.doc.sheet304;\n        \n//         if (d.item_type==\"Pipe 202\"){\n//             alert(\"This is Pipe 202\");\n//         }\n//         else if(d.item_type==\"Pipe 304\"){\n//             alert(\"This is Pipe 304\");\n//         }\n//         else if(d.item_type==\"Pipe 316\"){\n//             alert(\"This is Pipe 316\");\n//         }\n//         else if(d.item_type==\"Sheet 202\"){\n//             alert(\"This is Sheet 202\");\n//         }\n//         else if(d.item_type==\"Sheet 304\"){\n//             alert(\"This is Sheet 304\")\n//         }\n//     }\n    // else if (d.select_item_type==\"Blustor And Pillar\"){\n    //     if (){}\n    //     else if(){}\n    //     else if(){}\n    //     else if(){}\n    // }\n    // if (grade==\"202\"){\n    //     var we = d.weight;\n    //     var total_weight = d.weight_per_unit * d.pcs;\n    //     // alert(\"hey this is bloack for 202\");\n    //     var we_diff=total_weight-we;\n    //     var rate = a1 + d.margin;\n    //     var amt2 = rate * d.weight;\n    //     var rate21 = we_diff / d.pcs;\n\t   // var rate22 = d.weight_per_unit - rate21;\n\t   // var rate23 = rate22 * rate;\n    //     frappe.model.set_value(cdt, cdn, \"qty\", d.pcs);\n    //     frappe.model.set_value(cdt, cdn, \"rate1\", rate);\n    //     frappe.model.set_value(cdt, cdn, \"amt2\", amt2);\n    //     frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate23);\n    // }\n    // else if (grade==\"304\"){\n    //     var we = d.weight;\n    //     var total_weight = d.weight_per_unit * d.pcs;\n    //     // alert(\"hey this is bloack for 304\");\n    //     var we_diff=total_weight-we;\n    //     var rate = b1 + d.margin;\n    //     var amt2 = rate * d.weight;\n    //     var rate21 = we_diff / d.pcs;\n\t   // var rate22 = d.weight_per_unit - rate21;\n\t   // var rate23 = rate22 * rate;\n    //     frappe.model.set_value(cdt, cdn, \"qty\", d.pcs);\n    //     frappe.model.set_value(cdt, cdn, \"rate1\", rate);\n    //     frappe.model.set_value(cdt, cdn, \"amt2\", amt2);\n    //     frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate23);\n    // }\n    // if (grade==\"316\"){\n    //     var we = d.weight;\n    //     var total_weight = d.weight_per_unit * d.pcs;\n    //     // alert(\"hey this is bloack for 316\");\n    //     var we_diff=total_weight-we;\n    //     var rate = c1 + d.margin;\n    //     var amt2 = rate * d.weight;\n    //     var rate21 = we_diff / d.pcs;\n\t   // var rate22 = d.weight_per_unit - rate21;\n\t   // var rate23 = rate22 * rate;\n    //     frappe.model.set_value(cdt, cdn, \"qty\", d.pcs);\n    //     frappe.model.set_value(cdt, cdn, \"rate1\", rate);\n    //     frappe.model.set_value(cdt, cdn, \"amt2\", amt2);\n    //     frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate23);\n    // }\n    \n    \n// });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:34.988033",
  "module": "khetan_app",
  "name": "Box Unit-1",
  "script": "frappe.ui.form.on(\"Quotation Item\", \"qty_box\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    // var default_set = d.default_set;\n    var qty_box=d.qty_box;\n    if (d.products_type == \"Channel\"){\n                var inches = d.size;\n                // var total_set = qty_box * default_set;\n                var total_set = qty_box\n        // alert(inches);\n                if (inches<10){\n            // alert(\"This is less than 10\");\n                    var a=Number(inches);\n                    var add_in = a+2;\n            // alert(add_in)\n                    // alert(total_set);\n                    frappe.model.set_value(cdt, cdn, \"special_size\", add_in);\n            // var qty_box=d.qty_box;\n            // var total_set = qty_box * default_set;\n                    var total_inches1 = total_set * d.special_size;\n                    // alert(total_inches1);\n                    frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n                    frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n                    frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches1);\n                }\n                else{\n            // alert(\"This is more than 10\")\n            // var qty_box=d.qty_box;\n            // var total_set = qty_box * default_set;\n                    var total_inches2 = total_set * d.size;\n        // alert(total_inches);\n                    // alert(total_set);\n                    frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n                    frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n                    frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches2);\n                }\n    }\n    else if (d.products_type == \"Hinge\" || d.products_type == \"Door Closer\" || d.products_type == \"Slim Tandem Box\"|| d.products_type == \"Multipurpose Lock\" || d.products_type == \"Door Knob Lock\" || d.products_type == \"Sliding Roller\"){\n        // alert(\"This is Special Item.\");\n        var qty_box1 = d.qty_box;\n        // var total_set1 = qty_box1 * default_set;\n        var total_set1 = qty_box1 \n        var total_inches = total_set1 * 1;\n        // alert(total_inches);\n        frappe.model.set_value(cdt, cdn, \"total_set\", total_set1);\n        frappe.model.set_value(cdt, cdn, \"qty\", total_set1);\n        frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches);\n    }\n    \n    else if(d.products_type == \"Gas Spring\"){\n        // var total_set = qty_box * default_set;\n        var total_set = qty_box\n        var total_inches2 = total_set * d.size;\n        // alert(total_inches);\n        frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n        frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n        frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches2);\n    }\n\n\n        \n    // cur_frm.refresh_field(\"Quotation Item\");\n});\nfrappe.ui.form.on(\"Quotation Item\", \"special_size\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    // alert(\"This is special size block\");\n    var qty_box=d.qty_box;\n    // var default_set = d.default_set\n    // var total_set = qty_box * default_set;\n    var total_set = qty_box\n    var total_inches = total_set * d.special_size;\n    // alert(total_inches);\n    // alert(total_set);\n    frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n    frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n    frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches);\n    if (d.price_list_rate !== \"\"){\n        // alert(\"hey\")\n        var rate=d.price_amt*d.special_size;\n        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate);\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.281602",
  "module": "khetan_app",
  "name": "Price Amt Unit-1",
  "script": "frappe.ui.form.on(\"Quotation Item\", \"price_amt\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    // var default_set = d.default_set;\n    if (d.products_type == \"Channel\"){\n         var inches = d.size;\n        \n        if (inches<10){\n            // alert(\"This is less than 10\");\n            var rate=d.price_amt*d.special_size;\n            // alert(rate);\n            frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate);\n        }\n        else{\n            var rate0=d.price_amt * d.size;\n            frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate0);\n        }\n    }\n    else if (d.products_type == \"Hinge\" || d.products_type == \"Door Closer\" || d.products_type == \"Slim Tandem Box\"|| d.products_type == \"Multipurpose Lock\" || d.products_type == \"Door Knob Lock\" || d.products_type == \"Sliding Roller\"){\n        var rate1=d.price_amt;\n        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate1);\n    }\n    else if(d.products_type == \"Gas Spring\"){\n        \n        var rate012=d.price_amt;\n        // alert(rate012)\n        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate012);\n    }\n});\n\nfrappe.ui.form.on(\"Quotation Item\", \"discount_percentage\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    var discount = d.discount_percentage;\n    var price_list_rate = d.price_list_rate;\n    var dis_value = price_list_rate-((price_list_rate*discount)/100);\n    // alert(dis_value);\n    var new_value = price_list_rate * d.qty - dis_value * d.qty\n    // alert(new_value);\n    // frappe.model.set_value(cdt, cdn, \"rate\", dis_value);\n    frappe.model.set_value(cdt, cdn, \"discount_amt\", new_value);\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.532546",
  "module": "khetan_app",
  "name": "Discount Total Unit-1",
  "script": "frappe.ui.form.on('Quotation', {\n\tbefore_save(frm) {\n\t    var name  = frm.doc.name;\n\t    var qty = 0\n\t    var n=0\n\t    var m=0\n\t    var z=0\n\t\t$.each(frm.doc.items || [], function(i,d){\n\t\t \n\t\t   var a = d.discount_amt;\n\t\t  // alert(a)\n\t\t   n=n+a\n\t\t  // console.log(n)\n\t\t  // });\n\t\t});\n\t\tfrm.set_value(\"discounted_amount\",n);\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.439322",
  "module": "khetan_app",
  "name": "Filtered Option In Item Table Purchase invoice",
  "script": "cur_frm.cscript.company = function(frm) {\n    var company=cur_frm.doc.company\n    console.log(company)\n        cur_frm.set_query(\"item_code\", \"items\", function() {\n            return {\n                \"filters\": {\n                    \n                    \"company\":cur_frm.doc.company\n                    \n                    \n                }\n            };\n          });\n}",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.457219",
  "module": "khetan_app",
  "name": "Filtered option Purchase Receipt",
  "script": "cur_frm.cscript.company = function(frm) {\n    var company=cur_frm.doc.company\n    console.log(company)\n        cur_frm.set_query(\"item_code\", \"items\", function() {\n            return {\n                \"filters\": {\n                    \n                    \"company\":cur_frm.doc.company\n                    \n                    \n                }\n            };\n          });\n}",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.478090",
  "module": "khetan_app",
  "name": "Filtered Option in item : sales invoice",
  "script": "cur_frm.cscript.company = function(frm) {\n    var company=cur_frm.doc.company\n    console.log(company)\n        cur_frm.set_query(\"item_code\", \"items\", function() {\n            return {\n                \"filters\": {\n                    \n                    \"company\":cur_frm.doc.company\n                    \n                    \n                }\n            };\n          });\n}",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.298936",
  "module": "khetan_app",
  "name": "Filtered Option In Item: Quotation",
  "script": "cur_frm.cscript.company = function(frm) {\n    var company=cur_frm.doc.company\n    // console.log(company)\n        cur_frm.set_query(\"item_code\", \"items\", function() {\n            return {\n                \"filters\": {\n                    \"company\":cur_frm.doc.company\n                }\n            };\n          });\n}",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.097956",
  "module": "khetan_app",
  "name": "Material Transfer For Supplier",
  "script": "frappe.ui.form.on('Stock Entry', {\n\trefresh(frm) {\n\tfrm.set_query(\"voucher_no\",function(){\n\t    return{\n\t        filters:{\n\t            'party_name_':cur_frm.doc.party_name_,\n\t            'stock_entry_type':\"Material Transfer For Supplier\",\n\t            'returnable_or_non_returnable':\"Returnable\",\n\t             'pending_qty':['>',0]\n\t           \n\t        }\n\t        \n\t    };\n\t});\n\n\t\tfrm.set_query(\"delivery_note\",function(){\n\t    return{\n\t        filters:{\n\t            'customer':cur_frm.doc.party,\n\t            'pending_qty':['>',0]\n\t        }\n\t        \n\t    };\n\t});\n\n\tfrm.set_query(\"company_address\",function(){\n\t    return{\n\t        filters:{\n\t            'is_your_company_address':1\n\t        }\n\t    };\n\t});\n\tfrm.set_query(\"gatepass_no\",function(){\n\t    return{\n\t        filters:{\n\t             'purpose':\"Returnable Received Material\"\n\t        }\n\t    }\n\t})\n    \n\t}\n});\n\n\nfrappe.ui.form.on(\"Stock Entry\",\"company_address\",function(frm, cdt, cdn) {\n    \n    if(frm.doc.company_address){\n        return frm.call({\n            method : \"frappe.contacts.doctype.address.address.get_address_display\",\n            args:{\n                \"address_dict\":frm.doc.company_address\n            },\n            callback: function(r){\n                if(r.message)\n                    frm.set_value(\"company_address_display\", r.message);\n            }\n        });\n    \n    }\n    else{\n        frm.set_value(\"company_address_display\", \"\");\n    }\n    \n\t\n});\n\nfrappe.ui.form.on('Stock Entry', {\n     voucher_no: function(frm) {\n        frappe.call({\n\t\t\t\"method\": \"frappe.client.get\",\n\t\t\targs: {\n\t\t\t\tdoctype: \"Stock Entry\",\n\t\t\t\tname: frm.doc.voucher_no\n\t\t\t},\n\t\t\tcallback: function(data){\n\t\t\t\tfrm.clear_table('items');\n\t\t\t\tlet items = data.message.items;\n\t\t\t\t\n\t\t\t\tfor (var item in items) {\n\t\t\t\t\tvar row = frm.add_child(\"items\");\n\t\t\t\t\trow.item_code = items[item].item_code;\n\t\t\t\t\trow.qty = items[item].qty;\n\t\t\t\t\trow.uom = items[item].uom;\n\t\t\t\t\trow.stock_uom = items[item].stock_uom;\n\t\t\t\t\trow.basic_rate = items[item].basic_rate;\n\t\t\t\t\trow.transfer_qty = items[item].transfer_qty;\n\t\t\t\t\trow.conversion_factor = items[item].conversion_factor;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tfrm.refresh_field(\"items\");\n\t\t\t}\n\t\t});\n\t\t\n    },\n});\nfrappe.ui.form.on(\"Stock Entry\",{\n\tvalidate: function(frm)\n{\n    var a = 0;\n    $.each(frm.doc.items, function(i, d) {\n            a += d.qty;\n    });\n    frm.set_value(\"total_qty\",a);\n    frm.refresh_field(\"total_qty\");\n\n}});\n\nfrappe.ui.form.on('Stock Entry', {\n\tdelivery_note:function(frm) {\n\t    \n\t\tvar u = frm.doc.delivery_note;\n\t\n\t    frappe.call({\n\t        method:\"voucher_no\",\n\t        args:{\"no\":u},\n\t    }).then(records =>{\n\t        var item = records[\"item\"];\n\t       \n\t        var item_code = item.split(\",\");\n\t       var len = item_code.length;\n\n\t        var qty = records[\"qty\"];\n\t         var qty1 = qty.split(\",\");\n\n\t        var rate = records[\"rate\"];\n\t        var rate1 = rate.split(\",\");\n\n\t        var item_name = records[\"item_name\"];\n\t        var item_name1 = item_name.split(\",\");  \n\t        \n\t         var description = records[\"description\"];\n\t        var description1 = description.split(\",\");\n\t        \n\t        var amount = records[\"amount\"];\n\t         var amount1 = amount.split(\",\");\n\n\t        var stock_uom = records[\"stock_uom\"];\n\t        var stock_uom1 = stock_uom.split(\",\")\n\n\t        var uom = records[\"uom\"];\n\t        var uom1 = uom.split(\",\")\n\t        \n\t       \n\t       \n\t         var child = frm.doc.delivery_note_item;\n\t        \n\t        if(child === undefined)\n\t       \n\t         {\n\t            for(var a = 0;a < len; a++){\n\t             \n\t                   var row = frappe.model.add_child(cur_frm.doc, \"Stock entry\", \"delivery_note_item\");\n                \t         row.item_code = item_code[a];\n                \t         row.qty = qty1[a];\n                \t         row.rate = rate1[a];\n                \t         row.amount = amount1[a];\n                \t         row.stock_uom = stock_uom1[a];\n                \t         row.uom = uom1[a];\n                \t         row.item_name = item_name1[a];\n                \t         row.description = description1[a];\n                \t         frm.refresh_fields(\"delivery_note_item\");\n\t              }\n\t         }\n\t    });\n\t  \n}\n  \n});\n\nfrappe.ui.form.on(\"Stock Entry\",{\n    after_save:function(frm){\n         if(cur_frm.doc.stock_entry_type ==\"Subcontracting Received Material\"){\n        var a = cur_frm.doc.total_qty_delivery_note;\n        console.log(a);\n          $.each(frm.doc.items || [], function (i, d)\n            {\n                var b = d.qty;\n                console.log(b);\n                var c=(a - b);\n               \n                d.pending_qty = c;\n                console.log(c);\n            });\n         }\n    }\n});\nfrappe.ui.form.on(\"Stock Entry\",{\n    before_submit:function(frm){\n        if(cur_frm.doc.stock_entry_type ==\"Subcontracting Received Material\"){\n        var gate = cur_frm.doc.delivery_note;\n        var a = cur_frm.doc.total_qty_delivery_note;\n        \n        var b = cur_frm.doc.total_qty;\n        var c =(a-b)\n        \n        frm.set_value(\"total_pending_qty\",c);\n        frm.refresh_field(\"total_pending_qty\");\n       \n       \n        frappe.db.set_value('Delivery Note',gate, 'pending_qty',c)\n        }\n    }\n});\nfrappe.ui.form.on(\"Stock Entry\",{\n    after_save:function(frm){\n         if(cur_frm.doc.stock_entry_type ==\"Material Received For Supplier\"){\n        var a = cur_frm.doc.received_qty;\n      \n          $.each(frm.doc.items || [], function (i, d)\n            {\n                var b = d.qty;\n                console.log(b);\n                var c=(a - b);\n               \n                d.pending_qty_material_received = c;\n               \n            });\n         }\n    }\n});\nfrappe.ui.form.on(\"Stock Entry\",{\n\tvalidate: function(frm){\n    if(cur_frm.doc.stock_entry_type ==\"Material Transfer For Supplier\" && cur_frm.doc.returnable_or_non_returnable == \"Returnable\"){\n    var a = 0;\n    $.each(frm.doc.items, function(i, d) {\n            a += d.qty;\n    });\n    frm.set_value(\"pending_qty\",a);\n    frm.refresh_field(\"pending_qty\");\n}\n}});\nfrappe.ui.form.on(\"Stock Entry\",{\n    before_submit:function(frm){\n        if(cur_frm.doc.stock_entry_type ==\"Material Received For Supplier\"){\n            \n     \n        var gate = cur_frm.doc.voucher_no;\n        var a = cur_frm.doc.received_qty1;\n        \n        var b = cur_frm.doc.total_qty;\n        var c =(a-b)\n        \n        frm.set_value(\"received_pending_qty\",c);\n        frm.refresh_field(\"received_pending_qty\");\n       \n       \n        frappe.db.set_value('Stock Entry',gate, 'pending_qty',c)\n        }\n    }\n});\nfrappe.ui.form.on('Stock Entry Detail', {\n\titem_code(frm) {\n\t    if(cur_frm.doc.stock_entry_type ==\"Manufacturing Unit-2\" ){\n\t    cur_frm.add_fetch('batch_no','batch_qty','qty')\n\t    }\n\t}\n})\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.403289",
  "module": "khetan_app",
  "name": "Sales Invoice Fetch Data Unit-1",
  "script": "frappe.ui.form.on('Sales Invoice Item', {\n\titem_code:function(frm) {\n\t\t// your code here\n\t\tvar item_code = 0;\n\t\tvar rate = 0;\n\t\t$.each(frm.doc.items || {}, function (i, d){\n\t\t      item_code = d.item_code;\n\t\t      //rate = d.rate;\n\t\t      //alert(rate);\n\t\t      frappe.call({\n\t\t          method:\"inches\",\n\t\t          args:{\"item_code\":item_code},\n\t\t            }).then(records => {\n                        var inches = records['msg']\n                        var grade = records['grade']\n                        // var type1 = records['type']\n                        var shape_type = records['shape_type']\n                        var thickness = records['thickness']\n                        var company = records['company']\n                        var default_set = records['default_set']\n                        // var color = records['color']\n                        // console.log(color);\n                        // console.log(inches)\n                        // alert(color);\n                        d.grade = grade;\n                        d.shape_type = shape_type;\n                        d.thickness = thickness;\n                        d.size = inches;\n                        d.company = company;\n                        d.default_set = default_set;\n                        // d.color = color;\n\t\t            });\n\t   });\n\t}\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.496141",
  "module": "khetan_app",
  "name": "Box Sales Invoice Unit-1",
  "script": "frappe.ui.form.on(\"Sales Invoice Item\", \"qty_box\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    var default_set = d.default_set\n    if (default_set == 15){\n        var inches = d.size;\n        var qty_box=d.qty_box;\n        var total_set = qty_box * default_set;\n        // alert(inches);\n        if (inches<10){\n            // alert(\"This is less than 10\");\n            var a=Number(inches);\n            var add_in = a+2;\n            // alert(add_in)\n            frappe.model.set_value(cdt, cdn, \"special_size\", add_in);\n            // var qty_box=d.qty_box;\n            // var total_set = qty_box * default_set;\n            var total_inches1 = total_set * d.special_size;\n        // alert(total_inches);\n            frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n            frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n            frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches1);\n        }\n        else{\n            // alert(\"This is more than 10\")\n            // var qty_box=d.qty_box;\n            // var total_set = qty_box * default_set;\n            var total_inches2 = total_set * d.size;\n        // alert(total_inches);\n            frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n            frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n            frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches2);\n        }\n        \n    }\n    else{\n        alert(\"This is Special Item.\")\n        var qty_box1 = d.qty_box;\n        var total_set1 = qty_box1 * default_set;\n        var total_inches = total_set1 * 1;\n        // alert(total_inches);\n        frappe.model.set_value(cdt, cdn, \"total_set\", total_set1);\n        frappe.model.set_value(cdt, cdn, \"qty\", total_set1);\n        frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches);\n    }\n        \n    // cur_frm.refresh_field(\"Quotation Item\");\n});\nfrappe.ui.form.on(\"Sales Invoice Item\", \"special_size\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    alert(\"This is special size block\");\n    var qty_box=d.qty_box;\n    var default_set = d.default_set\n    var total_set = qty_box * default_set;\n    var total_inches = total_set * d.special_size;\n    // alert(total_inches);\n    // alert(total_set);\n    frappe.model.set_value(cdt, cdn, \"total_set\", total_set);\n    frappe.model.set_value(cdt, cdn, \"qty\", total_set);\n    frappe.model.set_value(cdt, cdn, \"total_inches\",total_inches);\n    if (d.price_list_rate != \"\"){\n        alert(\"hey\")\n        var rate=d.price_amt*d.special_size;\n        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate);\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.514336",
  "module": "khetan_app",
  "name": "Price Amt Sales Invoice Unit-1",
  "script": "frappe.ui.form.on(\"Sales Invoice Item\", \"price_amt\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    var default_set = d.default_set;\n    if (default_set == 15){\n        var inches = d.size;\n        // alert(inches);\n        if (inches<10){\n            // alert(\"This is less than 10\");\n            var rate=d.price_amt*d.special_size;\n            frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate);\n        }\n        else{\n            var rate0=d.price_amt * d.size;\n            frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate0);\n        }\n        \n    }\n    else{\n        // alert(\"This is Special Item.\");\n        var rate1=d.price_amt;\n        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate1);\n    }\n    \n    // alert(rate);\n    \n    // frappe.model.set_value(cdt, cdn, \"rate\",d.hi);\n    // cur_frm.refresh_field(\"Quotation Item\");\n});\n\nfrappe.ui.form.on(\"Sales Invoice Item\", \"discount_percentage\",function(frm, cdt, cdn){\n    var d = locals[cdt][cdn];\n    var discount = d.discount_percentage;\n    var price_list_rate = d.price_list_rate;\n    var dis_value = price_list_rate-((price_list_rate*discount)/100);\n    // alert(dis_value);\n    var new_value = price_list_rate * d.qty - dis_value * d.qty\n    // alert(new_value);\n    // frappe.model.set_value(cdt, cdn, \"rate\", dis_value);\n    frappe.model.set_value(cdt, cdn, \"discount_amt\", new_value);\n});",
  "view": "Form"
 },
 {
  "_liked_by": "[\"jignasa.chavda@sanskartechnolab.in\"]",
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Attendance",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.134848",
  "module": "khetan_app",
  "name": "Calculate Overtime",
  "script": "frappe.listview_settings['Attendance'] = {\r   \r    add_fields: [\"status\", \"attendance_date\"],\r\tget_indicator: function (doc) {\r\t\tif ([\"Present\", \"Work From Home\"].includes(doc.status)) {\r\t\t\treturn [__(doc.status), \"green\", \"status,=,\" + doc.status];\r\t\t} else if ([\"Absent\", \"On Leave\"].includes(doc.status)) {\r\t\t\treturn [__(doc.status), \"red\", \"status,=,\" + doc.status];\r\t\t} else if (doc.status == \"Half Day\") {\r\t\t\treturn [__(doc.status), \"orange\", \"status,=,\" + doc.status];\r\t\t}\r\t},\r    \r  onload: function (list_view) {\r\t\tlet me = this;\r\r\t\tlist_view.page.add_inner_button(__(\"Mark Attendance\"), function () {\r\t\t\tlet first_day_of_month = moment().startOf('month');\r\r\t\t\tif (moment().toDate().getDate() === 1) {\r\t\t\t\tfirst_day_of_month = first_day_of_month.subtract(1, \"month\");\r\t\t\t}\r\r\t\t\tlet dialog = new frappe.ui.Dialog({\r\t\t\t\ttitle: __(\"Mark Attendance\"),\r\t\t\t\tfields: [\r\t\t\t\t\t{\r\t\t\t\t\t\tfieldname: \"employee\",\r\t\t\t\t\t\tlabel: __(\"For Employee\"),\r\t\t\t\t\t\tfieldtype: \"Link\",\r\t\t\t\t\t\toptions: \"Employee\",\r\t\t\t\t\t\tget_query: () => {\r\t\t\t\t\t\t\treturn {\r\t\t\t\t\t\t\t\tquery: \"erpnext.controllers.queries.employee_query\",\r\t\t\t\t\t\t\t};\r\t\t\t\t\t\t},\r\t\t\t\t\t\treqd: 1,\r\t\t\t\t\t\tonchange: () => me.reset_dialog(dialog),\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tfieldtype: \"Section Break\",\r\t\t\t\t\t\tfieldname: \"time_period_section\",\r\t\t\t\t\t\thidden: 1,\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tlabel: __(\"Start\"),\r\t\t\t\t\t\tfieldtype: \"Date\",\r\t\t\t\t\t\tfieldname: \"from_date\",\r\t\t\t\t\t\treqd: 1,\r\t\t\t\t\t\tdefault: first_day_of_month.toDate(),\r\t\t\t\t\t\tonchange: () => me.get_unmarked_days(dialog),\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tfieldtype: \"Column Break\",\r\t\t\t\t\t\tfieldname: \"time_period_column\",\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tlabel: __(\"End\"),\r\t\t\t\t\t\tfieldtype: \"Date\",\r\t\t\t\t\t\tfieldname: \"to_date\",\r\t\t\t\t\t\treqd: 1,\r\t\t\t\t\t\tdefault: moment().subtract(1, 'days').toDate(),\r\t\t\t\t\t\tonchange: () => me.get_unmarked_days(dialog),\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tfieldtype: \"Section Break\",\r\t\t\t\t\t\tfieldname: \"days_section\",\r\t\t\t\t\t\thidden: 1,\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tlabel: __(\"Status\"),\r\t\t\t\t\t\tfieldtype: \"Select\",\r\t\t\t\t\t\tfieldname: \"status\",\r\t\t\t\t\t\toptions: [\"Present\", \"Absent\", \"Half Day\", \"Work From Home\"],\r\t\t\t\t\t\treqd: 1,\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tlabel: __(\"Exclude Holidays\"),\r\t\t\t\t\t\tfieldtype: \"Check\",\r\t\t\t\t\t\tfieldname: \"exclude_holidays\",\r\t\t\t\t\t\tonchange: () => me.get_unmarked_days(dialog),\r\t\t\t\t\t},\r\t\t\t\t\t{\r\t\t\t\t\t\tlabel: __(\"Unmarked Attendance for days\"),\r\t\t\t\t\t\tfieldname: \"unmarked_days\",\r\t\t\t\t\t\tfieldtype: \"MultiCheck\",\r\t\t\t\t\t\toptions: [],\r\t\t\t\t\t\tcolumns: 2,\r\t\t\t\t\t},\r\t\t\t\t],\r\t\t\t\tprimary_action(data) {\r\t\t\t\t\tif (cur_dialog.no_unmarked_days_left) {\r\t\t\t\t\t\tfrappe.msgprint(\r\t\t\t\t\t\t\t__(\r\t\t\t\t\t\t\t\t\"Attendance from {0} to {1} has already been marked for the Employee {2}\",\r\t\t\t\t\t\t\t\t[data.from_date, data.to_date, data.employee]\r\t\t\t\t\t\t\t)\r\t\t\t\t\t\t);\r\t\t\t\t\t} else {\r\t\t\t\t\t\tfrappe.confirm(\r\t\t\t\t\t\t\t__(\"Mark attendance as {0} for {1} on selected dates?\", [\r\t\t\t\t\t\t\t\tdata.status,\r\t\t\t\t\t\t\t\tdata.employee,\r\t\t\t\t\t\t\t]),\r\t\t\t\t\t\t\t() => {\r\t\t\t\t\t\t\t\tfrappe.call({\r\t\t\t\t\t\t\t\t\tmethod: \"hrms.hr.doctype.attendance.attendance.mark_bulk_attendance\",\r\t\t\t\t\t\t\t\t\targs: {\r\t\t\t\t\t\t\t\t\t\tdata: data,\r\t\t\t\t\t\t\t\t\t},\r\t\t\t\t\t\t\t\t\tcallback: function (r) {\r\t\t\t\t\t\t\t\t\t\tif (r.message === 1) {\r\t\t\t\t\t\t\t\t\t\t\tfrappe.show_alert({\r\t\t\t\t\t\t\t\t\t\t\t\tmessage: __(\"Attendance Marked\"),\r\t\t\t\t\t\t\t\t\t\t\t\tindicator: \"blue\",\r\t\t\t\t\t\t\t\t\t\t\t});\r\t\t\t\t\t\t\t\t\t\t\tcur_dialog.hide();\r\t\t\t\t\t\t\t\t\t\t}\r\t\t\t\t\t\t\t\t\t},\r\t\t\t\t\t\t\t\t});\r\t\t\t\t\t\t\t}\r\t\t\t\t\t\t);\r\t\t\t\t\t}\r\t\t\t\t\tdialog.hide();\r\t\t\t\t\tlist_view.refresh();\r\t\t\t\t},\r\t\t\t\tprimary_action_label: __(\"Mark Attendance\"),\r\t\t\t});\r\t\t\tdialog.show();\r\t\t});\r\t},\r\r\treset_dialog: function (dialog) {\r\t\tlet fields = dialog.fields_dict;\r\r\t\tdialog.set_df_property(\r\t\t\t\"time_period_section\",\r\t\t\t\"hidden\",\r\t\t\tfields.employee.value ? 0 : 1\r\t\t);\r\r\t\tdialog.set_df_property(\"days_section\", \"hidden\", 1);\r\t\tdialog.set_df_property(\"unmarked_days\", \"options\", []);\r\t\tdialog.no_unmarked_days_left = false;\r\t\tfields.exclude_holidays.value = false;\r\r\t\tfields.to_date.datepicker.update({\r            maxDate: moment().subtract(1, 'days').toDate()\r        });\r\r\t\tthis.get_unmarked_days(dialog)\r\t},\r\r\tget_unmarked_days: function (dialog) {\r\t\tlet fields = dialog.fields_dict;\r\t\tif (fields.employee.value && fields.from_date.value && fields.to_date.value) {\r\t\t\tdialog.set_df_property(\"days_section\", \"hidden\", 0);\r\t\t\tdialog.set_df_property(\"status\", \"hidden\", 0);\r\t\t\tdialog.set_df_property(\"exclude_holidays\", \"hidden\", 0);\r\t\t\tdialog.no_unmarked_days_left = false;\r\r\t\t\tfrappe\r\t\t\t\t.call({\r\t\t\t\t\tmethod: \"hrms.hr.doctype.attendance.attendance.get_unmarked_days\",\r\t\t\t\t\tasync: false,\r\t\t\t\t\targs: {\r\t\t\t\t\t\temployee: fields.employee.value,\r\t\t\t\t\t\tfrom_date: fields.from_date.value,\r\t\t\t\t\t\tto_date: fields.to_date.value,\r\t\t\t\t\t\texclude_holidays: fields.exclude_holidays.value,\r\t\t\t\t\t},\r\t\t\t\t})\r\t\t\t\t.then((r) => {\r\t\t\t\t\tvar options = [];\r\r\t\t\t\t\tfor (var d in r.message) {\r\t\t\t\t\t\tvar momentObj = moment(r.message[d], \"YYYY-MM-DD\");\r\t\t\t\t\t\tvar date = momentObj.format(\"DD-MM-YYYY\");\r\t\t\t\t\t\toptions.push({\r\t\t\t\t\t\t\tlabel: date,\r\t\t\t\t\t\t\tvalue: r.message[d],\r\t\t\t\t\t\t\tchecked: 1,\r\t\t\t\t\t\t});\r\t\t\t\t\t}\r\r\t\t\t\t\tdialog.set_df_property(\r\t\t\t\t\t\t\"unmarked_days\",\r\t\t\t\t\t\t\"options\",\r\t\t\t\t\t\toptions.length > 0 ? options : []\r\t\t\t\t\t);\r\t\t\t\t\tdialog.no_unmarked_days_left = options.length === 0;\r\t\t\t\t});\r\t\t}\r\t},\r refresh: function(listview) {\r    \r        \r      frappe.db.get_list('Attendance',{\r            fields:['in_time','out_time','name','shift','shift_hours']\r        }).then(result=>{\r       \r        for (var e in result ){\r            var intime=result[e].in_time;\r            var outtime=result[e].out_time;\r            var Name=result[e].name;\r            var shiftName=result[e].shift;\r            var Shift_Hours=result[e].shift_hours;\r            \r            if(intime !== null && outtime !== null)\r            {\r                var splitIn = intime.split(' ')[1];\r                var splitOut = outtime.split(' ')[1];\r                \r                // frappe.db.set_value('Attendance',Name,'check_in_time',splitIn);\r                \r                var timeStart = new Date(\"01/01/2007 \" + splitIn);\r                var timeEnd = new Date(\"01/01/2007 \" + splitOut);\r                var diff_of_work_hours = timeEnd - timeStart;              \r                var work_hours_result = new Date(diff_of_work_hours);    \r                var Work_Hours =\r                (\"0\" + work_hours_result.getUTCHours()).slice(-2) + \":\" +\r                (\"0\" + work_hours_result.getUTCMinutes()).slice(-2) + \":\" +\r                (\"0\" + work_hours_result.getUTCSeconds()).slice(-2);\r                \r                if(Work_Hours > Shift_Hours)\r                {\r                    var WorkHours = new Date(\"01/01/2007 \" + Work_Hours);\r                    var ShiftHours = new Date(\"01/01/2007 \" + Shift_Hours);\r                    var diff_of_overtime = WorkHours - ShiftHours;              \r                    var overtime_result = new Date(diff_of_overtime);    \r                    var OverTime =\r                    (\"0\" + overtime_result.getUTCHours()).slice(-2) + \".\" +\r                    (\"0\" + overtime_result.getUTCMinutes()).slice(-2);\r\t\t    \r                    frappe.db.set_value('Attendance',Name,'overtime',OverTime);\r                }\r                else\r                {\r                     frappe.db.set_value('Attendance',Name,'overtime','00.00');\r                }\r              \r            }\r           \r           \r               \r        }\r      \r        \r        \r       \r        });\r     \r        \r    }\r   \r    // ,\r    // after_submit: function(frm){\r    //      frappe.db.get_list('Attendance',{\r    //         fields:['in_time','out_time','name']\r    //     }).then(result=>{\r       \r    //     for (var e in result ){\r    //         var intime=result[e].in_time;\r    //         var outtime=result[e].out_time;\r    //         var Name=result[e].name;\r    //         if(intime !== null && outtime !== null)\r    //         {\r    //             var splitIn = intime.split(' ')[1];\r    //             var splitOut = outtime.split(' ')[1];\r                \r    //             frappe.db.set_value('Attendance',Name,'check_in_time',splitIn);\r    //             frappe.db.set_value('Attendance',Name,'check_out_time',splitOut);\r    //         }\r    //     }\r    //     });\r        \r    // }\r    \r \r};\r",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Shift Type",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.383757",
  "module": "khetan_app",
  "name": "Calculate Shifthours",
  "script": "frappe.ui.form.on('Shift Type', {\nstart_time: function (cur_frm, cdt, cdn) {\n    var d = locals[cdt][cdn];\n    var hours=0;\n    var minutes=0;\n    var seconds=0;\n    console.log(cdt, cdn, d.start_time, d.end_time, d.shift_hours);\n\n    if (d.start_time && d.end_time) {\n        \n\t\t\n\t    var hour1 = d.start_time.split(':')[0];\n        var hour2 = d.end_time.split(':')[0];\n        var min1 = d.start_time.split(':')[1];\n        var min2 = d.end_time.split(':')[1];\n\t\tvar sec1 = d.start_time.split(':')[2];\n        var sec2 = d.end_time.split(':')[2];\n\t\t\n\t\tvar diff_hour = hour2 - hour1;\n\t\tvar diff_min = min2 - min1;\n\t\tvar diff_sec = sec2 - sec1;\n\t\t\n\t\tif (diff_hour<0) {\n            diff_hour+= 24;\n        }\n        if (diff_min<0) {\n            diff_min+=60;\n            diff_hour--;\n        }if(diff_min>=60){\n            diff_min-=60;\n            diff_hour++;\n        }\n        if (diff_sec<0) {\n            diff_sec+=60;\n            diff_min--;\n        } else if(diff_sec>=60){\n            diff_sec-=60;\n            diff_min++;\n        }\n\t\n        \n       frappe.model.set_value(cdt,cdn,\"shift_hours\",diff_hour+\":\"+diff_min+\":\"+diff_sec);\n\t   frm.refresh_field(\"shift_hours\");\n    }\n},\nend_time: function (cur_frm, cdt, cdn) {\n    var d = locals[cdt][cdn];\n    var hours=0;\n    var minutes=0;\n    var seconds=0;\n    console.log(cdt, cdn, d.start_time, d.end_time, d.shift_hours);\n\n    if (d.start_time && d.end_time) {\n        \n\t\t\n\t    var hour1 = d.start_time.split(':')[0];\n        var hour2 = d.end_time.split(':')[0];\n        var min1 = d.start_time.split(':')[1];\n        var min2 = d.end_time.split(':')[1];\n\t\tvar sec1 = d.start_time.split(':')[2];\n        var sec2 = d.end_time.split(':')[2];\n\t\t\n\t\tvar diff_hour = hour2 - hour1;\n\t\tvar diff_min = min2 - min1;\n\t\tvar diff_sec = sec2 - sec1;\n\t\t\n\t\tif (diff_hour<0) {\n            diff_hour+= 24;\n        }\n        if (diff_min<0) {\n            diff_min+=60;\n            diff_hour--;\n        }if(diff_min>=60){\n            diff_min-=60;\n            diff_hour++;\n        }\n        if (diff_sec<0) {\n            diff_sec+=60;\n            diff_min--;\n        } else if(diff_sec>=60){\n            diff_sec-=60;\n            diff_min++;\n        }\n\t\t\n      frappe.model.set_value(cdt,cdn,\"shift_hours\",diff_hour+\":\"+diff_min+\":\"+diff_sec);\n\t   frm.refresh_field(\"shift_hours\");\n    }\n}\n\n\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.333019",
  "module": "khetan_app",
  "name": "Clear Tax Table in Purchase invoice",
  "script": "frappe.ui.form.on('Purchase Invoice', {\n\tsupplier:function(frm) {\n\t\tfrm.doc.taxes_and_charges = None;\n\t}\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 0,
  "modified": "2023-02-07 18:11:35.349829",
  "module": "khetan_app",
  "name": "Clear tax table in sales invoice",
  "script": "frappe.ui.form.on('Sales Invoice', {\n\tcustomer:function(frm) {\n\t\tfrm.doc.taxes_and_charges = None;\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.264347",
  "module": "khetan_app",
  "name": "Rate1 and w_diff for unit-2",
  "script": "frappe.ui.form.on(\"Quotation Item\", \"weight\",function(frm, cdt, cdn){\r    var d = locals[cdt][cdn];\r    var select_item_type = cur_frm.doc.select_item_type;\r    var margin = 0;\r    var rate202 = cur_frm.doc.rate202;\r    var rate304 = cur_frm.doc.rate304;\r    var rate316 = cur_frm.doc.rate316;\r    var sheet202 = cur_frm.doc.sheet202;\r    var sheet304 = cur_frm.doc.sheet304;\r    var cust_type = cur_frm.doc.customer_type;\r    var item_type = d.item_type;\r    var rate = 0;\r    \r    if (cust_type==\"Special\"){\r        margin = d.special_margin;\r    }\r    else{\r        margin = d.normal_margin;\r    }\r    if (select_item_type==\"Guage and Sheet\"){\r        var we = d.weight;\r        var pcs = d.pcs;\r        var total_weight = d.weight_per_unit * pcs;\r        var we_diff=total_weight-we;\r        \r        \r        if(item_type==\"Pipe 202\"){\r            rate = rate202 + margin;\r        }\r        else if(item_type==\"Pipe 304\"){\r            rate = rate304 + margin;\r        }\r        else if(item_type==\"Pipe 316\"){\r            rate = rate316 + margin;\r        }\r        else if(item_type==\"Sheet 202\"){\r            rate = sheet202 + margin;\r        }\r        else if(item_type==\"Sheet 304\"){\r            rate = sheet304 + margin;\r        }\r        \r        var amt2 = rate * we;\r        var rate21 = we_diff / pcs;\r        var rate22 = d.weight_per_unit - rate21;\r        var rate23 = rate22 * rate;\r        frappe.model.set_value(cdt, cdn, \"weight_diff\", we_diff);\r        frappe.model.set_value(cdt, cdn, \"rate1\", rate);\r        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate23);\r        \r    }\r    else if(select_item_type==\"Blustor And Pillar\"){\r        \r        if(item_type==\"550 Grm R Blustor 202\"){\r            rate = cur_frm.doc.rbgm55202;\r        }\r        else if(item_type==\"650 Grm R Blustor 202\"){\r            rate = cur_frm.doc.rbgm65202;\r        }\r        else if(item_type==\"700 Grm R Blustor 202\"){\r            rate = cur_frm.doc.rbgm70202;\r        }\r        else if(item_type==\"900 Grm R Blustor 202\"){\r            rate = cur_frm.doc.rbgm90202;\r        }\r        else if(item_type==\"1100 Grm R Blustor 202\"){\r            rate = cur_frm.doc.rbgm110202;\r        }\r        else if(item_type==\"700 Grm Sq Blustor 202\"){\r            rate = cur_frm.doc.sqbgm70202;\r        }\r        else if(item_type==\"800 Grm Sq Blustor 202\"){\r            rate = cur_frm.doc.sqbgm65202;\r        }\r        else if(item_type==\"900 Grm Sq Blustor 202\"){\r            rate = cur_frm.doc.sqbgm90202;\r        }\r        else if(item_type==\"1100 Grm Sq Blustor 202\"){\r            rate = cur_frm.doc.sqbgm110202;\r        }\r        else if(item_type==\"550 Grm R Blustor 304\"){\r            rate = cur_frm.doc.rbgm55304;\r        }\r        else if(item_type==\"650 Grm R Blustor 304\"){\r            rate = cur_frm.doc.rbgm65304;\r        }\r        else if(item_type==\"700 Grm R Blustor 304\"){\r            rate = cur_frm.doc.rbgm70304;\r        }\r        else if(item_type==\"900 Grm R Blustor 304\"){\r            rate = cur_frm.doc.rbgm90304;\r        }\r        else if(item_type==\"1100 Grm R Blustor 304\"){\r            rate = cur_frm.doc.rbgm110304;\r        }\r        else if(item_type==\"700 Grm Sq Blustor 304\"){\r            rate = cur_frm.doc.sqbgm70304;\r        }\r        else if(item_type==\"800 Grm Sq Blustor 304\"){\r            rate = cur_frm.doc.sqbgm65304;\r        }\r        else if(item_type==\"900 Grm Sq Blustor 304\"){\r            rate = cur_frm.doc.sqbgm90304;\r        }\r        else if(item_type==\"1100 Grm Sq Blustor 304\"){\r            rate = cur_frm.doc.sqbgm110304;\r        }\r        else if(item_type==\"1.1 Master Pillar 202\"){\r            rate = cur_frm.doc.mpillar11202;\r        }\r        else if(item_type==\"1.3 Master Pillar 202\"){\r            rate = cur_frm.doc.mpillar13202;\r        }\r        else if(item_type==\"1.5 Master Pillar 202\"){\r            rate = cur_frm.doc.mpillar15202;\r        }\r        else if(item_type==\"1.7 Master Pillar 202\"){\r            rate = cur_frm.doc.mpillar17202;\r        }\r        else if(item_type==\"2.2 Master Pillar 202\"){\r            rate = cur_frm.doc.mpillar22202;\r        }\r        else if(item_type==\"1.1 Master Pillar 304\"){\r            rate = cur_frm.doc.mpillar11304;\r        }\r        else if(item_type==\"1.3 Master Pillar 304\"){\r            rate = cur_frm.doc.mpillar13304;\r        }\r        else if(item_type==\"1.5 Master Pillar 304\"){\r            rate = cur_frm.doc.mpillar15304;\r        }\r        else if(item_type==\"1.7 Master Pillar 304\"){\r            rate = cur_frm.doc.mpillar17304;\r        }\r        else if(item_type==\"2.2 Master Pillar 304\"){\r            rate = cur_frm.doc.mpillar22304;\r        }\r        var total_weight1 = d.weight_per_unit * d.pcs;\r        var we_diff1 = total_weight1 - d.weight;\r        var rate233 = rate;\r        // console.log(\"This is total weight\", total_weight1);\r        // console.log(\"This is weight difference\", we_diff1);\r        // console.log(\"This is rate\", rate);\r        // console.log(\"This is rate233\", rate233);\r        frappe.model.set_value(cdt, cdn, \"weight_diff\", we_diff1);\r        frappe.model.set_value(cdt, cdn, \"rate1\", rate);\r        frappe.model.set_value(cdt, cdn, \"price_list_rate\", rate233);\r    }\r});\r\r",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2023-02-07 18:11:34.968516",
  "module": "khetan_app",
  "name": "filter apply on bom base on item name in stock entry",
  "script": "frappe.ui.form.on('Stock Entry', {\n\titem_name:function(frm) {\n\t    \n        frm.set_query(\"bom_no\", function(doc, cdn,cdt){\n            let d = locals[cdn][cdt];\n            return{\n                filters:{\n                    'item':d.item_name,\n                    'docstatus':1,\n                    'is_active':1,\n                }\n            };\n        });\n\t},\n\t\n\t\n\tcompany:function(frm){\n\t    var company = frm.doc.company;\n\t    \n\t    frm.set_query('item_code', 'items', function(doc, cdt, cdn) {\n            let d = locals[cdt][cdn];\n            return{\n\t\t\tfilters: {\n\t\t\t   'is_stock_item': 1,\n\t\t\t  'company': company, \n\t\t\t}\n            };\n\t    });\n\t    frm.set_value(\"items\",0);\n\t    \n\t    frm.set_query(\"operation\", function(doc, cdn,cdt){\n            let d = locals[cdn][cdt];\n            return{\n                filters:{\n                   \n                    'company': company,\n                }\n            }\n        })\n\t    \n\t}\n\t\n\t\n\n});\n\nfrappe.ui.form.on('Stock Entry Detail', {\n\tis_finished__item:function(frm) {\n        $.each(frm.doc.items || [], function(i,d){\n            \n            var finished = d.is_finished__item;\n            if (finished == 1){\n                \n                d.is_scrap_item = 0;\n                d.rejected_item = 0;\n                d.short_length = 0;\n                d.straightner = 0;\n                frm.refresh_field(\"items\");\n            }\n        });\n\t},\n\tis_scrap_item:function(frm){\n\t    $.each(frm.doc.items || [], function(i,d){\n            \n            var scrap  = d.is_scrap_item;\n            if (scrap == 1){\n                d.is_finished__item = 0;\n                d.rejected_item = 0;\n                d.short_length = 0;\n                d.straightner = 0;\n                frm.refresh_field(\"items\");\n            }\n        });\n\t},\n\tshort_length:function(frm){\n\t     $.each(frm.doc.items || [], function(i,d){\n            \n            var short_length  = d.short_length;\n            if (short_length == 1){\n                d.is_finished__item = 0;\n                d.is_scrap_item = 0;\n                d.rejected_item = 0;\n                d.straightner = 0;\n                frm.refresh_field(\"items\");\n            }\n        });\n\t},\n\t\n\trejected_item:function(frm){\n\t    $.each(frm.doc.items || [], function(i,d){\n\t        var rejected = d.rejected_item;\n\t        if(rejected == 1){\n\t            d.is_finished__item = 0;\n\t            d.is_scrap_item = 0;\n\t            d.short_length = 0;\n\t            d.straightner = 0;\n\t            frm.refresh_field(\"items\");\n\t        }\n\t    })\n\t},\n\t\n\tstraightner:function(frm){\n\t    $.each(frm.doc.items || [], function(i,d){\n\t        var straightner = d.straightner;\n\t        if(straightner == 1){\n\t            d.is_finished__item = 0;\n\t            d.is_scrap_item = 0;\n\t            d.short_length = 0;\n\t            d.rejected_item = 0;\n\t            frm.refresh_field(\"items\");\n\t        }\n\t    })\n\t},\n\t\n\t\n\t\n\t\n});\n\n\n\n\n\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.246631",
  "module": "khetan_app",
  "name": "Remove Add Multiple",
  "script": "frappe.ui.form.on('Quotation', {\n\trefresh(frm) {\n// \t\t$(\".grid-add-multiple-rows\").hide();\n        $(\".grid-add-multiple-rows\").remove();\n\t}\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.229237",
  "module": "khetan_app",
  "name": "Master Data Fetch From Bluster and Pillar",
  "script": "frappe.ui.form.on('Quotation', {\n\tselect_item_type: function(frm) {\n\t    var a = frm.doc.select_item_type;\n\t    if (a==\"Blustor And Pillar\"){\n\t       // frm.set_value(\"rbgm65202\", 12);\n\t       // alert(a);\n\t       // frappe.call({\n\t       //    // frappe.db.get_all \n        //     method: 'frappe.client.get_value',\n        //     args: {\n        //         'doctype': 'Item Type',\n        //         'fieldname': \"master_price\"\n        //     },\n        //     callback: function(r) {\n               \n        //             console.log(r);\n        //             // frm.set_value('inquiry_connect', r.message.inquiry_connect);\n        //             // alert(frm.doc.inquiry_connect)\n        //             // frm.refresh_field(\"your_seed_license_code\");\n                  \n        //         }\n        //     });\n    \n\t        frappe.call({\n\t\t          method:\"bluster_price\",\n\t\t            }).then(records => {\n\t\t                \n                    frm.set_value(\"mpillar11202\", records.mpillar11202);\n                    frm.set_df_property(\"mpillar11202\", \"read_only\",1);\n                    frm.set_value(\"mpillar13202\", records.mpillar13202);\n                    frm.set_df_property(\"mpillar13202\", \"read_only\",1);\n                    frm.set_value(\"mpillar15202\", records.mpillar15202);\n                    frm.set_df_property(\"mpillar15202\", \"read_only\",1);\n                    frm.set_value(\"mpillar17202\", records.mpillar17202);\n                    frm.set_df_property(\"mpillar17202\", \"read_only\",1);\n                    frm.set_value(\"mpillar22202\", records.mpillar22202);\n                    frm.set_df_property(\"mpillar22202\", \"read_only\",1);\n                    \n                    frm.set_value(\"mpillar11304\", records.mpillar11304);\n                    frm.set_df_property(\"mpillar11304\", \"read_only\",1);\n                    frm.set_value(\"mpillar13304\", records.mpillar13304);\n                    frm.set_df_property(\"mpillar13304\", \"read_only\",1);\n                    frm.set_value(\"mpillar15304\", records.mpillar15304);\n                    frm.set_df_property(\"mpillar15304\", \"read_only\",1);\n                    frm.set_value(\"mpillar17304\", records.mpillar17304);\n                    frm.set_df_property(\"mpillar17304\", \"read_only\",1);\n                    frm.set_value(\"mpillar22304\", records.mpillar22304);\n                    frm.set_df_property(\"mpillar22304\", \"read_only\",1);\n                    \n                    frm.set_value(\"rbgm55202\", records.rbgm55202);\n                    frm.set_df_property(\"rbgm55202\", \"read_only\",1);\n                    frm.set_value(\"rbgm65202\", records.rbgm65202);\n                    frm.set_value(\"rbgm70202\", records.rbgm70202);\n                    frm.set_df_property(\"rbgm70202\", \"read_only\",1);\n                    frm.set_value(\"rbgm90202\", records.rbgm90202);\n                    frm.set_df_property(\"rbgm90202\", \"read_only\",1);\n                    frm.set_value(\"rbgm110202\", records.rbgm110202);\n                    frm.set_df_property(\"rbgm110202\", \"read_only\",1);\n                    \n                    frm.set_value(\"rbgm55304\", records.rbgm55304);\n                    frm.set_df_property(\"rbgm55304\", \"read_only\",1);\n                    frm.set_value(\"rbgm65304\", records.rbgm65304);\n                    frm.set_value(\"rbgm70304\", records.rbgm70304);\n                    frm.set_df_property(\"rbgm70304\", \"read_only\",1);\n                    frm.set_value(\"rbgm90304\", records.rbgm90304);\n                    frm.set_df_property(\"rbgm90304\", \"read_only\",1);\n                    frm.set_value(\"rbgm110304\", records.rbgm110304);\n                    frm.set_df_property(\"rbgm110304\", \"read_only\",1);\n                    \n                    frm.set_value(\"sqbgm70202\", records.sqbgm70202);\n                    frm.set_df_property(\"sqbgm70202\", \"read_only\",1);\n                    frm.set_value(\"sqbgm65202\", records.sqbgm65202);\n                    frm.set_value(\"sqbgm90202\", records.sqbgm90202);\n                    frm.set_df_property(\"sqbgm90202\", \"read_only\",1);\n                    frm.set_value(\"sqbgm110202\", records.sqbgm110202);\n                    \n                    frm.set_value(\"sqbgm70304\", records.sqbgm70304);\n                    frm.set_df_property(\"sqbgm70304\", \"read_only\",1);\n                    frm.set_value(\"sqbgm65304\", records.sqbgm65304);\n                    frm.set_value(\"sqbgm90304\", records.sqbgm90304);\n                    frm.set_df_property(\"sqbgm90304\", \"read_only\",1);\n                    frm.set_value(\"sqbgm110304\", records.sqbgm110304);\n                    frm.set_df_property(\"sqbgm110304\", \"read_only\",1);\n\t\t      });\n\t    }\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.079480",
  "module": "khetan_app",
  "name": "Naming Series For Expense Bill",
  "script": "frappe.ui.form.on('Purchase Invoice', {\n\t\tonload(frm) {\n            if (frm.doc.purchase_or_expense == 'Expense Bill'){\n                frm.set_value('naming_series','EXP-.MM.-.YY.-');\n            }\n            else\n            {\n                frm.set_value('naming_series','PINV-.YY.-');\n            }\n\t    },\n\t    purchase_or_expense(frm) {\n            if (frm.doc.purchase_or_expense == 'Expense Bill'){\n                frm.set_value('naming_series','EXP-.MM.-.YY.-');\n            }\n            else\n            {\n                frm.set_value('naming_series','PINV-.YY.-');\n            }\n\t    }\n});\nfrappe.ui.form.on('Purchase Invoice', {\n\trefresh(frm) {\n\tfrm.set_query(\"gatepass_no\",function(){\n\t    return{\n\t        filters:{\n\t            \n\t            'purpose':\"Purchase Inward\"\n\t        }\n\t        \n\t    };\n\t});\n\t}\n})",
  "view": "Form"
 },
 {
  "_liked_by": "[\"jignasa.chavda@sanskartechnolab.in\"]",
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Timesheet",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.192354",
  "module": "khetan_app",
  "name": "Fetching working hours in Timesheet",
  "script": "frappe.ui.form.on('Timesheet', {\n\ton_submit(frm) {\n\t    \n\t\tvar nm = frm.doc.name;\n\t    var emp = frm.doc.employee_name;\n\t    var f_date = frm.doc.start_date;\n\t    var to_date = frm.doc.end_date;\n\t    \n\t    frappe.call({\n                        method: \"working_hours\", //dotted path to server method\n                        args:{\n                            \"from_date\": f_date,\n                            \"to_date\": to_date,\n                            \"emp_name\": emp,\n                            \"form_name\":nm,\n                        },\n                         callback: function(r) {\n                           \n                            // var a = r.message[0][0];\n                            var a = r.message[0][0];\n                            console.log(a);\n                        \n                            frm.set_value('total_hours',a);\n                           frm.save('Update');\n                         \n                         \n                        }\n                        });\n\t    \n\t    \n\t    \n\t},\n\temployee:function(frm) {\n\t    var emp = frm.doc.employee_name;\n\t    \n\t   var res = frappe.db.get_list('Employee',{\n            fields:['company'],\n            filters:{\n                employee_name:emp\n            }\n        }).then(result=>{\n            for(var d in result)\n            {\n                var company_name = result[d].company;\n                \n            }\n             console.log(company_name);\n             \n             frm.set_value('company',company_name);\n                \t \n             \n        });\n\t    \n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Delivery Note",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.172871",
  "module": "khetan_app",
  "name": "Delivery Note Pending Qty",
  "script": "frappe.ui.form.on(\"Delivery Note\",{\n\tvalidate: function(frm)\n{\n    var a = 0;\n    $.each(frm.doc.items, function(i, d) {\n            a += d.qty;\n    });\n    frm.set_value(\"pending_qty\",a);\n    frm.refresh_field(\"pending_qty\");\n\n}});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2023-02-07 18:11:34.944879",
  "module": "khetan_app",
  "name": "Total Weight Process loss Calculate",
  "script": "// frappe.ui.form.on('Stock Entry', {\n// \tbefore_save:function(frm) {\n// \t\tvar r_weigth = 0;\n// \t\tvar f_s_w = 0;\n\t\t\n// \t\t$.each(frm.doc.items || [], function(i,d){\n\t\t    \n// \t\t    if(d.s_warehouse == undefined)\n// \t\t    {\n// \t\t        var r = parseFloat(d.total_weight);\n// \t\t        f_s_w +=  r; \n\t\t        \n// \t\t    }\n// \t\t    else{\n// \t\t       var h = parseFloat(d.total_weight);\n// \t\t        r_weigth += h; \n// \t\t    }\n// \t\t})\n// \t\talert(f_s_w)\n// \t\talert(r_weigth)\n// \t\tvar a = r_weigth - f_s_w;\n// \t\tvar process_loss_p = (a/r_weigth)*100;\n// \t\tfrm.set_value(\"process_loss\",process_loss_p);\n// \t\tfrm.refresh_field(\"process_loss\");\n// \t\tfrm.set_value('raw_material_weight',r_weigth);\n// \t\tfrm.refresh_field(\"raw_material_weight\");\n// \t\tfrm.set_value('total_weight_out_put',f_s_w);\n// \t\tfrm.refresh_field(\"total_weight_out_put\");\n\t\n\t\t\n// \t}\n// })\n\n\nfrappe.ui.form.on('Stock Entry Detail', {\n\tqty:function(frm) {\n\t   \n\t\t$.each(frm.doc.items || [], function(i,d){\n\t\t    var qty = d.qty;\n\t\t    var p_u_w = d.weight_per_unit;\n\t\t    var total_w = qty * p_u_w;\n\t\t     d.total_weight = total_w;\n\t\t     frm.refresh_field(\"items\")\n\t\t})\n\t\t\n\t\tvar type = frm.doc.stock_entry_type;\n\t\tif(type == \"Manufacturing\" || type == \"Manufacturing Unit-2\")\n\t\t{\n        \t\tvar r_weigth = 0;\n        \t\tvar f_s_w = 0;\n        \t\t\n        \t\t$.each(frm.doc.items || [], function(i,d){\n        \t\t    \n        \t\t    if(d.s_warehouse == undefined)\n        \t\t    {\n        \t\t        var r = parseFloat(d.total_weight);\n        \t\t        f_s_w +=  r; \n        \t\t        \n        \t\t    }\n        \t\t    else{\n        \t\t       var h = parseFloat(d.total_weight);\n        \t\t        r_weigth += h; \n        \t\t    }\n        \t\t})\n        \t\tvar a = r_weigth - f_s_w;\n        \t\tvar process_loss_p = (a/r_weigth)*100;\n        \t\tfrm.set_value(\"process_loss\",process_loss_p);\n        \t\tfrm.refresh_field(\"process_loss\");\n        \t\tfrm.set_value('raw_material_weight',r_weigth);\n        \t\tfrm.refresh_field(\"raw_material_weight\");\n        \t\tfrm.set_value('total_weight_out_put',f_s_w);\n        \t\tfrm.refresh_field(\"total_weight_out_put\");\n\t\t}\n\t\telse if(type == \"Material Transfer\")\n\t\t{\n\t\t    var total_w = 0;\n\t\t    \n\t\t    $.each(frm.doc.items || [], function(i,d){\n\t\t        var r = parseFloat(d.total_weight);\n        \t\t total_w +=  r; \n\t\t    });\n\t\t    frm.set_value(\"total_weight\",total_w);\n\t\t    frm.refresh_field(\"total_weight\");\n\t\t}\n        \t\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Supplier",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.115554",
  "module": "khetan_app",
  "name": "Supplier name concatenate",
  "script": "frappe.ui.form.on('Supplier', {\n\tsupplier_name:function(frm) {\n\t    \n\t    var name = frm.doc.supplier_name;\n\t    var com  = frm.doc.company;\n\t   \n\t    var con = name + \"-\" + com;\n\t \n\t    frm.set_value(\"supplier_name_custom\", con);\n\t    \n\t},\n\t\n\tcompany:function(frm){\n\t    var name = frm.doc.supplier_name;\n\t    var com  = frm.doc.company;\n\t   \n\t    var con = name + \"-\" + com;\n\t \n\t    frm.set_value(\"supplier_name_custom\", con);\n\t    \n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "GatePass",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.060210",
  "module": "khetan_app",
  "name": "GatePass",
  "script": "frappe.ui.form.on('GatePass', {\n\tpurchase_invoice:function(frm) {\n\t    \n\t\tvar u = frm.doc.purchase_invoice;\n\t\n\t    frappe.call({\n\t        method:\"purchase_invoice\",\n\t        args:{\"no\":u},\n\t    }).then(records =>{\n\t        var item = records[\"item\"];\n\t       \n\t        var item_code = item.split(\",\");\n\t        var len = item_code.length;\n\n\t        var qty = records[\"qty\"];\n\t        var qty1 = qty.split(\",\");\n\n\t       var child = frm.doc.purchase_inward_table;\n\t        \n\t        if(child === undefined)\n\t       \n\t         {\n\t            for(var a = 0;a < len; a++){\n\t             \n\t                   var row = frappe.model.add_child(cur_frm.doc, \"GatePass\", \"purchase_inward_table\");\n                \t         row.item_name = item_code[a];\n                \t         row.qty = qty1[a];\n                \t        \n                \t         frm.refresh_fields(\"purchase_inward_table\");\n\t              }\n\t         }\n\t    });\n\t  \n}\n  \n});\nfrappe.ui.form.on('GatePass', {\n\tsales_invoice:function(frm) {\n\t    \n\t\tvar invoice = frm.doc.sales_invoice;\n\t\n\t    frappe.call({\n\t        method:\"sales_invoice\",\n\t        args:{\"no\":invoice},\n\t    }).then(records =>{\n\t        var item = records[\"item\"];\n\t       \n\t        var item_code = item.split(\",\");\n\t       var len = item_code.length;\n\n\t        var qty = records[\"qty\"];\n\t         var qty1 = qty.split(\",\");\n\n\t       \n\t         var child = frm.doc.purchase_inward_table;\n\t        \n\t        if(child === undefined)\n\t       \n\t         {\n\t            for(var a = 0;a < len; a++){\n\t             \n\t                   var row = frappe.model.add_child(cur_frm.doc, \"GatePass\", \"purchase_inward_table\");\n                \t         row.item_name = item_code[a];\n                \t         row.qty = qty1[a];\n                \t        \n                \t         frm.refresh_fields(\"purchase_inward_table\");\n\t              }\n\t         }\n\t    });\n\t  \n}\n  \n});\n\nfrappe.ui.form.on('GatePass', {\n\tpurpose:function(frm) {\n\t    if(frm.doc.purpose == \"Returnable Received Material\")\n         {\n   \t     frm.set_query(\"voucher_no\",function(){\n\t     return{\n\t        filters:{\n\t            \n\t            'stock_entry_type':\"Material Transfer For Supplier\"\n\t            \n\t        }\n\t        \n\t    };\n\t});\n         }\n          \n         \n\t}\n});\n\nfrappe.ui.form.on('GatePass',{\n    voucher_no:function(frm){\n        \n        var voucher = frm.doc.voucher_no;\n        \n        frappe.call({\n            method:\"voucher_num\",\n            args:{\"no\":voucher},\n        }).then(records =>{\n            var item = records[\"item\"];\n            \n            var item_code = item.split(\",\");\n            var len = item_code.length;\n           \n            var qty = records[\"qty\"]\n            var qty1 = qty.split(\",\")\n            \n           \n             var child = frm.doc.purchase_inward_table;\n\t        \n\t        if(child === undefined)\n\t       \n\t         {\n\t            for(var a = 0;a < len; a++){\n\t             \n\t                   var row = frappe.model.add_child(cur_frm.doc, \"GatePass\", \"purchase_inward_table\");\n\t                        row.item_name = item_code[a];\n\t                        row.qty = qty1[a];\n\t                       \n\t                        frm.refresh_fields(\"purchase_inward_table\")\n            \n\t            }\n\t         }\n            \n        })\n    }\n})\nfrappe.ui.form.on(\"GatePass\",{\n    purpose:function(frm) {\n\t    if(frm.doc.purpose == \"Purchase Return\")\n         {\n   \t     frm.set_query(\"purchase_invoice\",function(){\n\t     return{\n\t        filters:{\n\t            \n\t            'is_return':1\n\t        }\n\t        \n\t    };\n\t});\n    }\n    }\n})\n\nfrappe.ui.form.on('GatePass', {\n\tpurpose:function(frm) {\n\t     if(frm.doc.purpose == \"Returnable Or Non Returnable Transfer Material\")\n         {\n   \t     frm.set_query(\"voucher_no\",function(){\n\t     return{\n\t        filters:{\n\t            \n\t            'stock_entry_type':\"Material Transfer For Company\",\n\t            'returnable_or_non_returnable':[\"in\", [ \"Non Returnable\"]] \n\t        }\n\t        \n\t    };\n\t});\n         }\n         \n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.038139",
  "module": "khetan_app",
  "name": "Warehouse Filter in Sales Invoice",
  "script": "cur_frm.cscript.company = function(frm) {\n    var company=cur_frm.doc.company;\n    // console.log(company);\n    if (company==\"SANTOSH UNIT 1\"){\n        cur_frm.set_query(\"set_warehouse\", function() {\n            return {\n                \"filters\": {\n                    \"company\":cur_frm.doc.company,\n                    \"parent_warehouse\":\"All Warehouses - KG\",\n                    \"name\": [\"in\", [\"Finished Goods - KG\", \"Stores - KG\"]]\n                }\n            };\n          });\n    }\n    else if(company==\"SANTOSH UNIT 2\"){\n        cur_frm.set_query(\"set_warehouse\", function() {\n            return {\n                \"filters\": {\n                    \"company\":cur_frm.doc.company,\n                    \"parent_warehouse\":\"All Warehouses - SU2\",\n                    \"name\": [\"in\",[\"Finished Goods - SU2\", \"Stores - SU2\"]]\n                }\n            };\n          });\n    }\n    else{\n        cur_frm.set_query(\"set_warehouse\", function() {\n            return {\n                \"filters\": {\n                    \"company\":cur_frm.doc.company,\n                    \"parent_warehouse\":\"All Warehouses - SU3\",\n                    \"name\": [\"in\",[\"Finished Goods - SU3\", \"Stores - SU3\"]]\n                }\n            };\n          });\n    }\n        \n};",
  "view": "Form"
 },
 {
  "_liked_by": "[\"jignasa.chavda@sanskartechnolab.in\"]",
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payroll Entry",
  "enabled": 1,
  "modified": "2023-02-07 18:11:35.011740",
  "module": "khetan_app",
  "name": "Fetch employees based on payment frequency",
  "script": "frappe.ui.form.on('Payroll Entry', {\r    payroll_frequency(frm){\r        var payroll_frequency = frm.doc.payroll_frequency;\r\t\tvar name = frm.doc.name;\r\t\tfrm.set_value('payment_frequency', payroll_frequency);\r\r    },\r    after_save(frm){\r        \tvar name = frm.doc.name;\r            frappe.db.get_list('Payroll Entry',{\r                    fields:['payment_frequency'],\r                    filters:{\r        \r                        name:name\r                    }\r                }).then(result=>{\r           \r                        for (var e in result )\r                        {\r                            var r=result[e].payment_frequency;\r                        }\r                        if(r !== '')\r                        {\r                            frm.add_custom_button(\"Get Employees Based On Payroll Frequency\", function (click){\r                                        var row;\r                                        frappe.db.get_list('Employee',{\r                                            fields:['employee','employee_name','department','designation'],\r                                            filters:{\r                                \r                                                payment_frequency:r\r                                            }\r                                        }).then(res=>{\r                                \r                                            for (var e in res ){\r                                                var emp=res[e].employee;\r                                                var emp_nm=res[e].employee_name;\r                                                var depart=res[e].department;\r                                                var design=res[e].designation;\r                                                \r                                                \r                                                \r                                                console.log(emp, emp_nm, depart, design);\r                                                \r                                                row = frm.add_child(\"employees\");\r                                                row.employee = emp;\r                                                row.employee_name = emp_nm;\r                                                row.department = depart;\r                                                row.designation = design;\r                                                frm.refresh_field(\"employees\");\r                                    \r                                            }\r                                    \r                                            frm.save();\r                                        });\r                                         \r                    \r                            });  \r                            \r                        }\r                   \r                });\r      \r    \r        \r    }\r\t\r});\r",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2023-02-07 18:11:34.870883",
  "module": "khetan_app",
  "name": "Total Discount Amount",
  "script": "frappe.ui.form.on('Sales Invoice', {\n\tbefore_save(frm) {\n\t\t// your code here\n\t\tvar n=0;\n\t    var c=0;\n\t\t$.each(frm.doc.items || [], function(i,d){\n\t\t   var a = d.price_list_rate * d.qty;\n\t\t   var b = d.rate * d.qty;\n\t\t   c = a-b;\n\t\t   d.discount_amount_12 = c;\n\t\t  // console.log(c)\n\t\t   n=n+c;\n\t\t  // console.log(n)\n\t\t});\n// \t\talert(\"This is the main working of the number\")\n// \t\talert(n)\n\t\tfrm.set_value(\"total_discount_amount\",n);\n\t}\n});\n",
  "view": "Form"
 }
]